name: PHP CodeCoverage from CodeClimate
on:
    - push
jobs:
    build:
        runs-on: ubuntu-latest
        steps:
            -   uses: actions/checkout@v2
            -   name: Setup PHP with xdebug
                uses: shivammathur/setup-php@v2
                with:
                    php-version: '7.4'
                    coverage: xdebug
            -   name: Test & publish code coverage
                uses: paambaati/codeclimate-action@v2.7.5
                env:
                    CC_TEST_REPORTER_ID: 433db4745bebadde1699ced55e0c7da80b0bad17c6d54aa319399e8fb90768ea
                run: |
                     ./cc-test-reporter before-build
                     ./vendor/bin/phpunit tests/genDiffTest.php --coverage-clover clover.xml
                     ./cc-test-reporter after-build --coverage-input-type clover --exit-code $?